CREATE TABLE Image_categories (
Id Serial PRIMARY KEY,
Title VARCHAR(100) NOT NULL
);


CREATE TABLE Images (
Id Serial PRIMARY KEY,
Image_link character varying(100), 
Category_id Int NOT NULL REFERENCES Image_categories (Id)
);


CREATE TABLE Languages (
Id Serial PRIMARY KEY ,
Title VARCHAR(100) NOT NULL,
Img_id int REFERENCES Images (Id)
);


CREATE TABLE Artworks (
Id Serial Primary key,
Title VARCHAR(100) NOT NULL,
Views int NOT NULL default 0,
Image_id int REFERENCES Images (Id),
Likes int NOT NULL default 0,
Dislikes int NOT NULL default 0,
Author int NOT NULL REFERENCES Users (Id),
Language_id Int NOT NULL REFERENCES Languages (Id),
Description VARCHAR(400) NOT NULL,
Status VARCHAR(25) NOT NULL CHECK(Status IN('В процессе','Завершено', 'Заморожено'))
);


CREATE TABLE Transfers (
Id Serial Primary key,
Title VARCHAR(100) NOT NULL,
Views int NOT NULL default 0,
Img_id int REFERENCES Images (Id),
Likes int NOT NULL default 0,
Dislikes int NOT NULL default 0,
Author VARCHAR(100) NOT NULL,
User_id int NOT NULL REFERENCES Users (Id),
Transfer_status VARCHAR(25) CHECK(Transfer_status IN('Активен','Завершен', 'Заморожен')),
Original_status VARCHAR(25) NOT NULL CHECK(Original_status IN('В процессе','Завершено', 'Заморожено')),
Transfer_language_id Int NOT NULL REFERENCES Languages (Id),
Original_language_id Int NOT NULL REFERENCES Languages (Id),
Description VARCHAR(400) NOT NULL,
Original_link VARCHAR(100)
);


CREATE TABLE Favorites (
Id Serial PRIMARY KEY ,
User_id int NOT NULL REFERENCES Users (Id),
Artwork_id Int NOT NULL REFERENCES Artworks (Id)
);

CREATE TABLE Chapters (
Id Serial PRIMARY KEY ,
Number int NOT NULL,
Title VARCHAR(100) NOT NULL,
Price int NOT NULL default 0,
Text_link VARCHAR(100) NOT NULL,
Artwork_id Int REFERENCES Artworks (Id),
Transfer_id Int REFERENCES Transfers (Id)
);

CREATE TABLE Genres (
Id Serial PRIMARY KEY ,
Name VARCHAR(100) NOT NULL
);

CREATE TABLE Tags (
Id Serial PRIMARY KEY ,
Name VARCHAR(100) NOT NULL
);

CREATE TABLE Work_genres (
Id Serial PRIMARY KEY ,
Artwork_id int REFERENCES Artworks (Id),
Transfer_id int REFERENCES Transfers (Id),
Gеnre_id int NOT NULL REFERENCES Genres (Id)
);


CREATE TABLE Work_tags (
Id Serial PRIMARY KEY ,
Artwork_id int REFERENCES Artworks (Id),
Transfer_id int REFERENCES Transfers (Id),
Tag_id int NOT NULL REFERENCES Tags (Id)
);


CREATE TABLE Buying_a_chapters (
Id Serial PRIMARY KEY ,
Chapter_id int NOT NULL REFERENCES Chapters (Id),
User_id int NOT NULL REFERENCES Users (Id)
);


CREATE TABLE Subscription_types (
Id Serial PRIMARY KEY,
Title VARCHAR(100) NOT NULL,
Price int NOT NULL default 0,
Period int NOT NULL
);


CREATE TABLE Subscriptions (
Id Serial PRIMARY KEY ,
Artwork_id Int NOT NULL REFERENCES Artworks (Id),
User_id int NOT NULL REFERENCES Users (Id),
Type_id int NOT NULL REFERENCES Subscription_types (Id)
);



--------------------------------------------------------------------------------------------------------





INSERT INTO Image_categories 
(Title)
VALUES
('Books'),
('Languages'),
('Transfers');


INSERT INTO Images
(Img_link, Category_id)
VALUES
('/img/Books/sheriff2.jpg', 1),
('/img/Country/ru.png', 2);


INSERT INTO Languages
(Title, Img_id)
VALUES
('Россия', 2);


INSERT INTO Artworks
(Title, Views, Img_id, Likes, Dislikes, Author, Language_id, Description, Status)
VALUES
('Шериф', 407, 1, 0, 0, 1, 1, 'Серьезный человек в игровом мире.', 'Завершено');



-------------------------------------------------------------------------------------------------------------------------
